
```ruby
# 上位システムから来るリクエストパラメータのイメージ（json）
 # 入館時 
{
  user_id: 1,
  in: "2019-07-11 10:00:00",
  out: nil,
} 

# 入館できないパターン 
#  - 無制限で入れる会員だが決済エラーが起こっている
#  - 退場記録がない
#  - プラン関連（ここはプラン詳細が決まってないので詰めれない）

 # 退館時
{
  user_id: 1,
  in: nil,
  out: "2019-07-11 18:00:00",
} 

# 退館できないパターン 
#  - 従量課金関連（ここはプラン詳細が決まってないので詰めれない）
#  - 入館記録がない
#  - プラン関連（ここはプラン詳細が決まってないので詰めれない）


## つまり、「決済エラー」「入退のどちらかがNULL」「プラン/従量課金関連」の3つが止めるタイミング


# kintone内部でやる処理（通常時）
 # - 入室した瞬間にuser_idと入室時間を受け取る
 # - そのuserがその日時に入れる権限があるか確認
 #    - そのuserが持っているプランを確認
 #    - プラン側にT/Fを返すメソッドを定義しといてそこで返してもらう
 # - 最終的なT/Fを上位システムに返す  

# kintoneから返すレスポンスのイメージ（json）
{
 is_valid: true
}

```

